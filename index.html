<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snack Innovation Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        select, input[type="text"] { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #4CAF50; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #45a049; }
        #reportOutput { margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Generate Your Snack Innovation Report</h1>

        <label for="productType">Product Type:</label>
        <select id="productType">
            <option value="Snack">Snack</option>
            <option value="Beverage">Beverage</option>
        </select>

        <label for="ingredients">Ingredients (e.g., Coconut, Mango):</label>
        <input type="text" id="ingredients" value="Coconut" placeholder="Enter ingredients, comma-separated">

        <label for="region">Region:</label>
        <input type="text" id="region" value="Mexico" placeholder="Enter region (e.g., Mexico, Global)">

        <button onclick="generateReport()">Generate Report</button>

        <div id="reportOutput">
            </div>
    </div>

<script>
    async function generateReport() {
        const productType = document.getElementById('productType').value;
        const ingredients = document.getElementById('ingredients').value;
        const region = document.getElementById('region').value;
        const reportOutput = document.getElementById('reportOutput');

        reportOutput.innerHTML = '<p>Generating your report... this may take a moment.</p>';

        try {
            const response = await fetch('/.netlify/functions/generate-report', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ productType, ingredients, region }),
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.error || `HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            reportOutput.innerHTML = data.report; // Display the raw report (which includes images)

        } catch (error) {
            console.error('Error:', error);
            reportOutput.innerHTML = `<p style="color: red;">Error generating report: ${error.message}. Please try again.</p>`;
        }
    }
</script>
</body>
</html>
